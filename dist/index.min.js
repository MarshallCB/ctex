!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).ctex={})}(this,(function(t){"use strict";const e={CONTEXT:Symbol("ctex-context"),MODEL:Symbol("ctex-model")};class s{constructor(t,e){Object.assign(this,{values:t,subs:e});const s=(t,e)=>(this.subs[t]=this.subs[t]||new Set,this.subs[t].add(e),()=>this.subs[t].delete(e));this.$=new Proxy(t=>s("",t),{get:(t,e)=>t=>s(e,t)})}setter(t){let s=[];for(const n in t){const o=t[n],u=this.values[n];u&&u[e.CONTEXT]?s.push([n,u(o)]):u!==o&&(this.values[n]=o,s.push([n,o]))}s.length>0&&(s.push(["",this.all()]),s.forEach(([t,e])=>{const s=this.subs[t];if(s)for(const t of s)t(e)}))}getter(t){const s=this.values[t];return s&&s[e.CONTEXT]?s():s}all(){let t={};return Object.keys(this.values).forEach(e=>{"function"!=typeof this.values[e]&&(t[e]=this.getter(e))}),t}}function n(t){let n=(n={})=>{let o=new s(Object.assign({},t,n),{});return new Proxy((function(t){return o.setter(t),o.all()}),{get:(t,s)=>s===e.CONTEXT||("$"===s?o.$:o.getter(s)),set:(t,e,s)=>(o.setter({[e]:s}),!0)})};return n[e.MODEL]=!0,n}t.CTEX=e,t.Context=t=>n(t)(),t.Model=n,Object.defineProperty(t,"__esModule",{value:!0})}));
